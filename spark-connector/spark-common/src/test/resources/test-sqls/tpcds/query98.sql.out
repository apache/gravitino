-- Automatically generated by Gravitino Spark SQL test
-- !query
select i_item_id
      ,i_item_desc 
      ,i_category 
      ,i_class 
      ,i_current_price
      ,sum(ss_ext_sales_price) as itemrevenue 
      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over
          (partition by i_class) as revenueratio
from	
	store_sales
    	,item 
    	,date_dim
where 
	ss_item_sk = i_item_sk 
  	and i_category in ('Jewelry', 'Sports', 'Books')
  	and ss_sold_date_sk = d_date_sk
	and d_date between cast('2001-01-12' as date) 
				and (cast('2001-01-12' as date) + interval 30 days)
group by 
	i_item_id
        ,i_item_desc 
        ,i_category
        ,i_class
        ,i_current_price
order by 
	i_category
        ,i_class
        ,i_item_id
        ,i_item_desc
        ,revenueratio
-- !query schema
struct<i_item_id:string,i_item_desc:string,i_category:string,i_class:string,i_current_price:string,itemrevenue:decimal(17,2),revenueratio:decimal(38,17)>
-- !query output
AAAAAAAAABBAAAAA	Ways share electronic benefits. Just effective groups repeat social relations. Always coming deaths would treat so ideas. Effective, grand patterns would hold more. Capable feet	Sports	tennis	1.09	885.55	13.86477325212735144
AAAAAAAAACIDAAAA	About military signals could consider swiftly also international records. Good, following owners get fairly obvious sales; players might understand with 	Jewelry	custom	4.81	1155.50	25.00692532765456466
AAAAAAAAADHBAAAA	Ears can think on the pockets. Necessary, essential men used to earn only small developments. Ill, nuclear teeth must welcome brief, equal clubs. Officials shall necessitate so ancient	Sports	fishing	2.11	8037.63	100.00000000000000000
AAAAAAAAAGEBAAAA	Now concerned efforts sue main, future instruments. Hardly deaf days may 	Jewelry	gold	63.04	142.32	100.00000000000000000
AAAAAAAAAPLDAAAA	Times would miss low, national methods. Versions stick real partners; sports characterize spatial, upper grounds. Values might reveal togeth	Sports	tennis	2.44	490.84	7.68492496535959481
AAAAAAAABHEBAAAA	Previous things may not account; pounds need ultimately products. Owners must use that pleased, different opportunities. Typically diffi	Jewelry	womens watch	0.20	257.92	5.96992815347011332
AAAAAAAACAIBAAAA	Flowers affect again eq	Sports	athletic shoes	9.98	919.16	46.56355908591228932
AAAAAAAACDEBAAAA	Late different pains would face broken, sound incomes. Certain reasons would tell years. Children used to boost rem	Books	reference	9.09	1984.50	17.70537611768253623
AAAAAAAACDJCAAAA	Thirdly urb	Jewelry	pendants	9.85	6285.50	33.76668725993177362
AAAAAAAACFICAAAA	Books will not interview. Again gay courses should estimate together to a others. White, likely weeks last. Weapons ought to cause around personally social clubs. Slightly northern feet determine	Sports	archery	0.14	21.84	0.59387848332571951
AAAAAAAACIADAAAA	Also general goals please deeply dirty, invisible functions. Estimated, expensive clients will recover never like a police. Emissions would 	Jewelry	rings	8.76	9140.40	82.47545470048914647
AAAAAAAACJIDAAAA	Southern, physical forms may inherit long forms. Directors find suddenly. Standards should not say under just difficult reasons. Paths join a bit scientific issues. Onl	Sports	outdoor	6.99	3383.15	77.94181002209366886
AAAAAAAACKNDAAAA	As scientific things call again occupations. Barriers see large possibilities. At random local p	Jewelry	womens watch	3.74	364.32	8.43270868824531516
AAAAAAAACNJBAAAA	Local, deep thoughts accept finally only attractive regulations. Single residents check final things. Most forward individuals feel theoretical, average sets. Onc	Books	fiction	1.51	11148.40	72.93867953537608393
AAAAAAAACOLBAAAA	Vehicles will go. Ways will retreat courts. Years cannot enable especially days. Wings might lay soviet videos	Books	mystery	75.18	369.34	100.00000000000000000
AAAAAAAACPLAAAAA	Artists can start usually canadian relatives. Foreign, great homes can go rapidly sometimes southern types. Persons will feed quite. Practical, 	Books	sports	3.07	60.18	18.73132470119521912
AAAAAAAADDOCAAAA	Girls lead badly reasonable regions. Also cultural levels suffer best liable, big feet. Open voters make in order expectations. False, regional ports may see years. Quite l	Books	travel	2.74	675.36	100.00000000000000000
AAAAAAAADECEAAAA	Open, other words include a little sharply anxious soldiers. Conditions mean now rules. Patients shall vary around a problems. Difficult edges take stil	Books	home repair	7.66	1679.73	48.93106311082628137
AAAAAAAADFFDAAAA	American units put here despite the others. Local, short years would go somewhere for a eyes. European, simple countries could not negotiate even talks. Again mental areas can 	Sports	basketball	7.42	2486.76	100.00000000000000000
AAAAAAAAEAMAAAAA	Rates see quite into a terms. Gastric, good plants used to scrape to a hands. High abilities sell secondly years. Trying, british practices need long, small situations. Indeed s	Jewelry	mens watch	2.71	283.65	6.41195179677062777
AAAAAAAAEAMDAAAA	Products wish only stones. Miles must hear cases. Again additional followers must not get else 	Books	science	0.61	363.30	1.53523562253741107
AAAAAAAAEDNDAAAA	Adult, agricultural conditions shall pay better relativel	Jewelry	jewelry boxes	6.85	10608.84	84.16648221005205247
AAAAAAAAEHIAAAAA	Safe, hot others write even anywhere hard movements. Inc, short views keep naturally radical women; criticisms find sooner. Now eager practices shall know thus unacceptable similar	Sports	camping	0.41	5074.08	80.66245821086048667
AAAAAAAAEKLAAAAA	Figures could not stay long certain examples. Numbers can follow. Children could not buy now important individuals. Either outstanding years remove in general typical divis	Books	sports	3.96	247.42	77.01070717131474104
AAAAAAAAEKPDAAAA	Groups make past, happy strategies; explicitly english variations may reflect critica	Books	sports	6.07	13.68	4.25796812749003984
AAAAAAAAELIAAAAA	So heavy years may not laugh only votes. Ministers explain over. Left sides should bring then reluctant products. Elements would issue little now full societ	Sports	camping	6.74	1038.78	16.51344644551872583
AAAAAAAAELJBAAAA	Presents will refute rural emotions. Special years ask surprisingly to a feet; also just numbers may att	Jewelry	earings	4.22	1574.84	100.00000000000000000
AAAAAAAAELOCAAAA	Military methods see relatively k	Jewelry	loose stones	0.41	2374.29	63.18348382152180682
AAAAAAAAEONBAAAA	Either sudden centuries will not grant even historica	Jewelry	consignment	0.15	4376.64	100.00000000000000000
AAAAAAAAFBDEAAAA	Present	Jewelry	costume	2.50	7452.75	31.36564443978692699
AAAAAAAAFBNAAAAA	Shares might handle just throughout a sources	Jewelry	womens watch	0.21	2718.54	62.92450559217835716
AAAAAAAAFDJCAAAA	Soon british records must tolerate often to a children. Forward, running women understand residential, necessary executives. Impossible, new classes should elect so remarkable yea	Sports	archery	2.05	3655.68	99.40612151667428049
AAAAAAAAFFBCAAAA	Illustrations	Sports	baseball	0.54	563.16	52.72885593101317379
AAAAAAAAFIECAAAA	No longer statistical months should find well basic, american bu	Jewelry	semi-precious	7.24	279.44	100.00000000000000000
AAAAAAAAFOCEAAAA	Very only cases help. Mere, dangerous figures could not note quickly political wea	Books	fiction	1.92	0.00	0.00000000000000000
AAAAAAAAGBMBAAAA	Local friends think like the devices. Only, sc	Sports	baseball	3.09	483.23	45.24498375513796429
AAAAAAAAGHPBAAAA	Black, recent mothers should not allow very consistent cells. Labour, simple arms could not lay in general only main reports. Sure, chief trends look double parents. Small, local metres sha	Jewelry	custom	4.97	1858.56	40.22230301771152548
AAAAAAAAGIBBAAAA	Intentionally poor generations can benefit alone. Royal, new regions must see gloomily important, nearby functions. Unemployed, personal efforts reduce completely from a terms	Jewelry	estate	5.35	26.00	12.03815168071117696
AAAAAAAAGJKDAAAA	There domestic letters call. Topics sell low factors. General, tall specialists might determine by the regulations	Sports	hockey	6.36	2709.08	22.98395751868823085
AAAAAAAAGLOBAAAA	Finally h	Books	science	3.99	8893.08	37.58043823307184041
AAAAAAAAHDLBAAAA	Sweet points involve enough. Frequently flexible accounts attract quietly to the features. Hence primitive farmers must not perform with a blocks. Just excessive fields kick further simple, high citi	Jewelry	costume	3.61	9009.72	37.91830854678300921
AAAAAAAAHJMDAAAA	Words must long both near a	Sports	hockey	5.95	3856.38	32.71770272414211455
AAAAAAAAHLGBAAAA	Efforts might not suggest proceedings; featur	Jewelry	womens watch	0.17	979.54	22.67285756610621435
AAAAAAAAHMFBAAAA	Running, intense things improve sure members. Permanent, certain leaders seal decisions.	Sports	athletic shoes	1.73	67.95	3.44226667814933206
AAAAAAAAICNAAAAA	Capital shoulders live vari	Books	computers	4.38	99.00	10.39784901062891232
AAAAAAAAIDMAAAAA	Crucial restaurants make for a children. Too united results begin effectively results. Others feel only in a collections. Aware pp. go simply. Neighbours mig	Sports	pools	7.53	728.65	54.36996798913570666
AAAAAAAAIFBDAAAA	Activities would show here. Practical	Jewelry	custom	3.00	122.76	2.65672882148236638
AAAAAAAAIFFCAAAA	Certain, blue women must tell american words. Elsewhere real kinds might not love etc regular systems. Other, full-time reasons destroy also most dear 	Sports	tennis	5.73	1825.74	28.58502751661565198
AAAAAAAAIFLBAAAA	Underlying children help academic times. Ago different	Books	science	7.43	348.66	1.47336981049791837
AAAAAAAAIFPDAAAA	Principles would not instruct like the consumers. Calls should forget now by a outcomes. Enough burning islands shed highly other, remaining at	Sports	camping	4.71	177.65	2.82409534362078750
AAAAAAAAIHNAAAAA	Once again recent prem	Sports	baseball	0.83	21.64	2.02616031384886192
AAAAAAAAIJOAAAAA	Here massive ranks feel already. Sexual ea	Books	fiction	0.40	333.26	2.18036169692148055
AAAAAAAAIKEDAAAA	Organizations work probably. Material churches used to accept seconds; video-taped, secure subjects may spend good. Designs go reliable, known pupils. Politicians force in a	Books	self-help	1.68	2167.16	100.00000000000000000
AAAAAAAAILAEAAAA	Alm	Jewelry	costume	27.05	6976.50	29.36129863931749974
AAAAAAAAIPJCAAAA	Available companies identify quickly available, wrong visitors. Pu	Sports	outdoor	6.99	957.46	22.05818997790633114
AAAAAAAAJDHAAAAA	Continued ideas reflect only still other prices. Actually historical weeks help low, appropriate companies; recent provisions widen du	Books	parenting	2.16	3662.19	46.17942461555921239
AAAAAAAAJHOBAAAA	Combined, broad years could not make still better good users. Services provide yet into the functions. Now international policies like across long, econ	Jewelry	pendants	7.79	12329.00	66.23331274006822638
AAAAAAAAJLHBAAAA	Inc, little sections will make now native, greek ways; greek, good children live most so new pupils. 	Jewelry	rings	17.40	1094.10	9.87225887136286980
AAAAAAAAKDLBAAAA	Exact charges cannot result local conditions. Available savings shall put quite correctly local users. Ever positive groups move; els	Books	science	3.27	5489.96	23.19951048253643068
AAAAAAAAKECDAAAA	Etc serious incentives must not call free judges; anyway european voices ought to use other residents. Trees used to like from a changes. Fair, english years take also reluctant doors; complete mo	Jewelry	rings	4.61	848.07	7.65228642814798373
AAAAAAAAKHECAAAA	Only, subsequent minerals should exist just f	Jewelry	mens watch	2.69	100.62	2.27453054747421317
AAAAAAAAKHJCAAAA	Famous tourists will make. Sensible, potential teams lead armed, democratic types. Social, growing recommendations get in 	Books	parenting	1.60	0.00	0.00000000000000000
AAAAAAAAKPDDAAAA	Dates may make yet in a causes. Really small hospitals include colours; delighted, remote events used to resolve also safe corporati	Sports	athletic shoes	2.05	969.25	49.10105927588285655
AAAAAAAALFJDAAAA	Friendly offices feel. Delightful servants give almost previously natural earnings. Written, important books press subject, american parents. New, reduced days shall n	Sports	tennis	0.40	8.95	0.14012728881095341
AAAAAAAALGNBAAAA	Straig	Sports	athletic shoes	46.34	17.63	0.89311496005552206
AAAAAAAAMAKAAAAA	However important children could expect sincerely by way of a potatoes. Even able cars suggest by the issues. Shoes would perform sincerely 	Sports	pools	4.17	611.52	45.63003201086429334
AAAAAAAAMBGBAAAA	Cultural women used to include well over here dull opportunities. Thin, other stars see so for a par	Books	home repair	2.59	885.36	25.79081521185021192
AAAAAAAAMCAAAAAA	Serious, little suppliers object hot, new weeks. Votes shall prevail yet. Windows understand equal members. Average consequences go at least pales	Jewelry	mens watch	0.37	4039.50	91.31351765575515906
AAAAAAAAMDDCAAAA	Artists solve never good thanks. Completely medieval homes enhance real goods. Other fears cannot make earlier; packages describe despite a companies; other numbers work similar roles.	Books	parenting	9.15	4268.16	53.82057538444078761
AAAAAAAAMHAEAAAA	Reasons might bear unaware soldiers. Eyes used to see for example cruel, close workers. Matches can care. Stupid departments shall get quite to a sources; really positive police must 	Books	fiction	9.82	3705.76	24.24502539153737548
AAAAAAAAMHCBAAAA	Illegal, late carers should build totally processes; illegally simple cells shou	Jewelry	bracelets	1.61	530.40	100.00000000000000000
AAAAAAAAMJODAAAA	Certain, light forms work years. Political, british movements	Jewelry	estate	4.16	189.98	87.96184831928882304
AAAAAAAAMMPCAAAA	Presumably social groups detect marked, tough generations. Narrow weeks should tell almost wide values. Favorite waves will not use; so wide patients would deal later fr	Books	reference	2.44	9223.96	82.29462388231746377
AAAAAAAANBLAAAAA	Police	Books	science	75.92	NULL	NULL
AAAAAAAANEMCAAAA	Br	Jewelry	costume	3.77	50.79	0.21375479938234585
AAAAAAAANOKAAAAA	So ethnic championships think totally soft, appropriate customers. Perfect, military enterprises used to reach away essential authorities. Stages	Books	fiction	5.77	97.20	0.63593337616506004
AAAAAAAANPDAAAAA	Years teach then at once right heads. Agencies will say by a suppliers. Most permanent blacks should not promote as other, legal eyes. Courses get so double, light flowers. Eastern, british times c	Books	romance	2.90	454.16	100.00000000000000000
AAAAAAAAOBHBAAAA	Programmes present also available, perfect schools. Chief police may see then. Sufficient, fair governments would direct never in no lights. Initial, new walls 	Sports	hockey	5.56	5221.37	44.29833975716965461
AAAAAAAAOCGBAAAA	About total honours carry now never emotio	Books	computers	0.76	853.12	89.60215098937108768
AAAAAAAAODEEAAAA	General managers may not give. Fine costs c	Books	home repair	3.24	132.62	3.86326230391657078
AAAAAAAAODPDAAAA	Possible, constant needs see sometimes. Small, soft procedures might pay deeply soft points. More thick experiences go. Local g	Books	home repair	4.53	735.14	21.41485937340693593
AAAAAAAAOKBAAAAA	Once sweet resources must talk effective, suspicious galleries. Citizens must not capitalise electronically further forward decisions. Developments would n	Jewelry	loose stones	2.86	1383.48	36.81651617847819318
AAAAAAAAOLNDAAAA	Senior judges save. Possib	Sports	tennis	9.46	3175.97	49.72514697708644836
AAAAAAAAOMADAAAA	Social businesses must create at first brilliant, old homes. Po	Jewelry	jewelry boxes	3.74	1995.75	15.83351778994794753
AAAAAAAAONBAAAAA	Top, new subjects could learn small things. Economic, open unions see public, careful tenants. Constant, popula	Jewelry	diamonds	2.41	369.84	100.00000000000000000
AAAAAAAAOPCDAAAA	Main, early drugs keep honestly so other houses; dark times find social,	Jewelry	custom	14.20	1483.90	32.11404283315154348
AAAAAAAAOPOBAAAA	Duties must look. Right due de	Sports	football	0.13	674.73	100.00000000000000000
AAAAAAAAPAABAAAA	Urban, substantial problems salvage actually degrees. Firmly different women ought to allow impossible, painful cases. Neatly giant forms know even english kids. Severe christians shall undergo pre	Jewelry	costume	3.89	271.11	1.14099357473021821
AAAAAAAAPABDAAAA	Hardly historical dollars combine quit	Sports	golf	3.32	131.10	22.55677907777013076
AAAAAAAAPFACAAAA	Twice part-time songs will end certainly free charges. Schools would make particularly terms; more fresh services change too. Books may secure in order artists; students should look right tired at	Books	science	5.32	8569.12	36.21144585135639948
AAAAAAAAPJNDAAAA	Terms used to settle with the considerations; final contents would address more old agreements; areas would not get either hard, deaf heads. Successfully standard hours will reconstruct. Events	Sports	golf	1.27	450.10	77.44322092222986924
