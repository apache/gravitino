-- Automatically generated by Gravitino Spark SQL test
-- !query
select  dt.d_year
 	,item.i_category_id
 	,item.i_category
 	,sum(ss_ext_sales_price)
 from 	date_dim dt
 	,store_sales
 	,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
 	and store_sales.ss_item_sk = item.i_item_sk
 	and item.i_manager_id = 1  	
 	and dt.d_moy=12
 	and dt.d_year=1998
 group by 	dt.d_year
 		,item.i_category_id
 		,item.i_category
 order by       sum(ss_ext_sales_price) desc,dt.d_year
 		,item.i_category_id
 		,item.i_category
limit 100
-- !query schema
struct<d_year:bigint,i_category_id:bigint,i_category:string,sum(ss_ext_sales_price):decimal(17,2)>
-- !query output
1998	1	Women	4067.90
1998	10	Electronics	1156.36
1998	2	Men	240.00
1998	3	Children	1610.70
1998	4	Shoes	4184.94
1998	5	Music	7662.68
1998	6	Jewelry	7850.43
1998	7	Home	404.60
1998	9	Books	15387.57
