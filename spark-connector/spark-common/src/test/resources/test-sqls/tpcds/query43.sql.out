-- Automatically generated by Gravitino Spark SQL test
-- !query
select  s_store_name, s_store_id,
        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales
 from date_dim, store_sales, store
 where d_date_sk = ss_sold_date_sk and
       s_store_sk = ss_store_sk and
       s_gmt_offset = -5 and
       d_year = 1998 
 group by s_store_name, s_store_id
 order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales
 limit 100
-- !query schema
struct<s_store_name:string,s_store_id:string,sun_sales:decimal(17,2),mon_sales:decimal(17,2),tue_sales:decimal(17,2),wed_sales:decimal(17,2),thu_sales:decimal(17,2),fri_sales:decimal(17,2),sat_sales:decimal(17,2)>
-- !query output
able	AAAAAAAACAAAAAAA	5538.13	3996.17	2314.98	5765.18	3608.12	2872.24	6585.15
ation	AAAAAAAAHAAAAAAA	6161.54	5668.23	4654.48	6279.76	8439.02	6995.42	4913.20
bar	AAAAAAAAKAAAAAAA	8354.63	3985.82	4348.83	7498.32	3417.42	3613.97	2277.97
eing	AAAAAAAAIAAAAAAA	3441.00	3924.06	5688.32	5055.39	3005.07	3859.57	4952.76
ese	AAAAAAAAEAAAAAAA	7434.69	2306.78	4897.31	3339.66	4087.83	3178.11	6080.70
ought	AAAAAAAABAAAAAAA	6091.13	3114.54	2899.12	4767.96	5687.76	4983.62	6044.06
