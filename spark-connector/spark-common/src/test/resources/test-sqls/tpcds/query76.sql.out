-- Automatically generated by Gravitino Spark SQL test
-- !query
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (
        SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price
         FROM store_sales, item, date_dim
         WHERE ss_addr_sk IS NULL
           AND ss_sold_date_sk=d_date_sk
           AND ss_item_sk=i_item_sk
        UNION ALL
        SELECT 'web' as channel, 'ws_web_page_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price
         FROM web_sales, item, date_dim
         WHERE ws_web_page_sk IS NULL
           AND ws_sold_date_sk=d_date_sk
           AND ws_item_sk=i_item_sk
        UNION ALL
        SELECT 'catalog' as channel, 'cs_warehouse_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price
         FROM catalog_sales, item, date_dim
         WHERE cs_warehouse_sk IS NULL
           AND cs_sold_date_sk=d_date_sk
           AND cs_item_sk=i_item_sk) foo
GROUP BY channel, col_name, d_year, d_qoy, i_category
ORDER BY channel, col_name, d_year, d_qoy, i_category
limit 100
-- !query schema
struct<channel:string,col_name:string,d_year:bigint,d_qoy:bigint,i_category:string,sales_cnt:bigint,sales_amt:decimal(17,2)>
-- !query output
catalog	cs_warehouse_sk	1998	1	Books	2	1143.90
catalog	cs_warehouse_sk	1998	1	Children	2	NULL
catalog	cs_warehouse_sk	1998	1	Electronics	6	3576.80
catalog	cs_warehouse_sk	1998	1	Home	1	988.68
catalog	cs_warehouse_sk	1998	1	Jewelry	3	9729.53
catalog	cs_warehouse_sk	1998	1	Men	7	10238.05
catalog	cs_warehouse_sk	1998	1	Music	3	8015.04
catalog	cs_warehouse_sk	1998	1	Shoes	3	8916.08
catalog	cs_warehouse_sk	1998	1	Sports	4	5616.97
catalog	cs_warehouse_sk	1998	1	Women	6	8803.88
store	ss_addr_sk	1998	1	Books	3	NULL
store	ss_addr_sk	1998	1	Home	2	1267.36
store	ss_addr_sk	1998	1	Men	1	210.56
store	ss_addr_sk	1998	1	Music	2	3496.26
store	ss_addr_sk	1998	1	Shoes	3	NULL
store	ss_addr_sk	1998	1	Sports	4	121.80
store	ss_addr_sk	1998	1	Women	4	100.10
store	ss_addr_sk	1998	2	Books	1	NULL
store	ss_addr_sk	1998	2	Children	4	2148.40
store	ss_addr_sk	1998	2	Jewelry	2	NULL
store	ss_addr_sk	1998	2	Men	2	292.03
store	ss_addr_sk	1998	2	Music	2	2281.29
store	ss_addr_sk	1998	2	NULL	1	NULL
store	ss_addr_sk	1998	2	Shoes	2	5127.42
store	ss_addr_sk	1998	2	Sports	3	1173.18
store	ss_addr_sk	1998	2	Women	1	NULL
store	ss_addr_sk	1998	3	Books	4	2590.22
store	ss_addr_sk	1998	3	Children	1	NULL
store	ss_addr_sk	1998	3	Electronics	2	3338.52
store	ss_addr_sk	1998	3	Home	6	6630.14
store	ss_addr_sk	1998	3	Jewelry	2	5550.70
store	ss_addr_sk	1998	3	Men	4	1593.36
store	ss_addr_sk	1998	3	Music	1	2285.49
store	ss_addr_sk	1998	3	Shoes	3	1321.60
store	ss_addr_sk	1998	3	Sports	5	13548.48
store	ss_addr_sk	1998	3	Women	3	2297.82
store	ss_addr_sk	1998	4	Books	9	9069.62
store	ss_addr_sk	1998	4	Children	6	3548.46
store	ss_addr_sk	1998	4	Electronics	10	7146.20
store	ss_addr_sk	1998	4	Home	5	1317.95
store	ss_addr_sk	1998	4	Jewelry	3	2083.56
store	ss_addr_sk	1998	4	Men	8	3660.40
store	ss_addr_sk	1998	4	Music	6	9088.42
store	ss_addr_sk	1998	4	Shoes	7	4520.42
store	ss_addr_sk	1998	4	Sports	5	3145.52
store	ss_addr_sk	1998	4	Women	4	5555.82
store	ss_addr_sk	1999	1	Books	3	689.13
store	ss_addr_sk	1999	1	Children	2	1278.90
store	ss_addr_sk	1999	1	Electronics	2	678.96
store	ss_addr_sk	1999	1	Home	3	8186.13
store	ss_addr_sk	1999	1	Jewelry	1	NULL
store	ss_addr_sk	1999	1	Men	5	3491.65
store	ss_addr_sk	1999	1	Music	4	352.63
store	ss_addr_sk	1999	1	Sports	1	3668.54
store	ss_addr_sk	1999	1	Women	2	NULL
store	ss_addr_sk	1999	2	Books	3	2444.91
store	ss_addr_sk	1999	2	Children	2	NULL
store	ss_addr_sk	1999	2	Electronics	4	NULL
store	ss_addr_sk	1999	2	Home	1	NULL
store	ss_addr_sk	1999	2	Music	2	NULL
store	ss_addr_sk	1999	2	Shoes	2	NULL
store	ss_addr_sk	1999	2	Sports	2	773.16
store	ss_addr_sk	1999	2	Women	1	558.90
store	ss_addr_sk	1999	3	Books	4	1639.47
store	ss_addr_sk	1999	3	Children	2	NULL
store	ss_addr_sk	1999	3	Electronics	4	2834.44
store	ss_addr_sk	1999	3	Home	3	4443.66
store	ss_addr_sk	1999	3	Jewelry	3	3801.84
store	ss_addr_sk	1999	3	Men	2	9093.15
store	ss_addr_sk	1999	3	Music	2	720.18
store	ss_addr_sk	1999	3	Shoes	1	115.52
store	ss_addr_sk	1999	3	Sports	2	NULL
store	ss_addr_sk	1999	3	Women	4	4014.28
store	ss_addr_sk	1999	4	Books	2	708.48
store	ss_addr_sk	1999	4	Children	8	8731.31
store	ss_addr_sk	1999	4	Electronics	8	658.00
store	ss_addr_sk	1999	4	Home	4	7686.50
store	ss_addr_sk	1999	4	Jewelry	7	308.73
store	ss_addr_sk	1999	4	Men	6	10993.38
store	ss_addr_sk	1999	4	Music	6	7654.80
store	ss_addr_sk	1999	4	Shoes	7	800.12
store	ss_addr_sk	1999	4	Sports	6	6557.85
store	ss_addr_sk	1999	4	Women	6	NULL
store	ss_addr_sk	2000	1	Books	2	3503.12
store	ss_addr_sk	2000	1	Children	1	1913.04
store	ss_addr_sk	2000	1	Electronics	1	NULL
store	ss_addr_sk	2000	1	Home	4	936.87
store	ss_addr_sk	2000	1	Jewelry	3	1551.23
store	ss_addr_sk	2000	1	Men	2	10.65
store	ss_addr_sk	2000	1	Music	2	680.61
store	ss_addr_sk	2000	1	Shoes	3	NULL
store	ss_addr_sk	2000	1	Sports	2	65.66
store	ss_addr_sk	2000	1	Women	1	NULL
store	ss_addr_sk	2000	2	Books	1	128.96
store	ss_addr_sk	2000	2	Electronics	4	2603.61
store	ss_addr_sk	2000	2	Jewelry	3	536.22
store	ss_addr_sk	2000	2	Men	3	1614.65
store	ss_addr_sk	2000	2	Music	1	1629.18
store	ss_addr_sk	2000	2	Shoes	1	8054.88
store	ss_addr_sk	2000	3	Books	2	1248.30
