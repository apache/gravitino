-- Automatically generated by Gravitino Spark SQL test
-- !query
select  dt.d_year 
       ,item.i_brand_id brand_id 
       ,item.i_brand brand
       ,sum(ss_ext_sales_price) sum_agg
 from  date_dim dt 
      ,store_sales
      ,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
   and store_sales.ss_item_sk = item.i_item_sk
   and item.i_manufact_id = 436
   and dt.d_moy=12
 group by dt.d_year
      ,item.i_brand
      ,item.i_brand_id
 order by dt.d_year
         ,sum_agg desc
         ,brand_id
 limit 100
-- !query schema
struct<d_year:bigint,brand_id:bigint,brand:string,sum_agg:decimal(17,2)>
-- !query output
1998	10003008	exportiunivamalg #x	2997.82
1999	3003001	exportiexporti #x	552.87
2001	10003008	exportiunivamalg #x	3110.54
2001	6012004	importobrand #x	1282.05
2002	6008005	namelesscorp #x	432.48
2002	8004007	edu packnameless #x	220.46
